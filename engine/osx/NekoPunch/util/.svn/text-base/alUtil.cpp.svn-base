//
//  alUtil.cpp
//  NyanTest4
//
//  Created by Eric Wing on 7/7/09.
//  Copyright 2009 PlayControl Software, LLC. All rights reserved.
//
//  Original source from Beginning iPhone Games Development, Apress, 2010
//  CHAPTER 12: Streaming: Thumping, Pulse-Quickening Game Excitement
//
//  Modified by Samuel Cartwright on 17/2/13.
//

#include "alUtil.h"
#include <stddef.h> // NULL 
#include <stdio.h> // printf

bool IsOpenALCaptureExtensionAvailable()
{
	if(!alcIsExtensionPresent(NULL, "ALC_EXT_CAPTURE"))
	{
#if defined(DEBUG)
        printf("ALC_EXT_CAPTURE not available\n");
#endif
		return false;
	}
	else
	{
#if defined(DEBUG)
        printf("ALC_EXT_CAPTURE is available\n");
#endif
		return true;
	}
}

ALCdevice* InitOpenALCaptureDevice(ALCuint sample_frequency, ALCenum al_format, ALCsizei max_buffer_size)
{
	ALCdevice* al_capture_device;
	
	/* This check is broken under Snow Leopard */
	/*
     if(!IsOpenALCaptureExtensionAvailable())
     {
     return NULL;
     }
     */
	
	al_capture_device = alcCaptureOpenDevice(NULL, sample_frequency, al_format, max_buffer_size);
	if(NULL == al_capture_device)
	{
#if defined(DEBUG)
		printf("Failed to get capture device\n");
#endif
		return NULL;
	}
	
#if defined(DEBUG)
	printf("Finished initializing AL capture\n");
#endif
	return al_capture_device;
}

